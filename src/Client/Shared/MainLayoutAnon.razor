@using System.Text.RegularExpressions;

@inject IStringLocalizer<MainLayoutAnon> L

<CascadingValue Value="@AppDataService" Name="AppDataService">
    <HeaderAnon CssClasses="@($"{_cssClasses}")" />

    <SliderAnon HideIfThesePages="about-us,get-started,contact-us,users,users/,login,loans,loans/,catalog,catalog/" OnHideChange=@( () => {} ) />

    <MudMainContent Class="@($"d-flex {_cssClasses}")">
        <MudContainer MaxWidth="MaxWidth.False" Class="mt-4">
            @ChildContent
            <MudScrollToTop TopOffset="400" Style="z-index:2000;">
                <MudFab Icon="@Icons.Material.Filled.KeyboardArrowUp" Color="Color.Primary" />
            </MudScrollToTop>
        </MudContainer>
    </MudMainContent>

    <Footer />
</CascadingValue>

@code {

    [Inject]
    protected AppDataService AppDataService { get; set; } = default!;

    private string _currentUrl = default!;
    private Uri _uri = default!;
    private string _cssClasses = default!;

    protected override void OnParametersSet()
    {
        _currentUrl = Navigation.Uri;

        _uri = new Uri(_currentUrl);

        if (_uri is { } && _uri.Segments.Count() > 1)
        {

            _cssClasses = _uri.Segments.ToList().ElementAt(1).ToString().ToLower();

            _cssClasses = _cssClasses.Replace("/", "");

        }
        else
        {
            _cssClasses = "home";
        }
    }
}