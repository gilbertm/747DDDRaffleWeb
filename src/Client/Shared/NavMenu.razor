@inject IStringLocalizer<NavMenu> L

@if (AppDataService != default)
{
    <PersonCard Style="background-color: var(--mud-palette-drawer-background);color: var(--mud-palette-drawer-text); margin-bottom:0px!important" />
    <MudNavMenu>

        @* Personal *@
        <MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">@L["Home"]</MudNavLink>

        <MudText Typo="Typo.subtitle2" Color="Color.Primary" Class="ml-4 my-3">@L["Personal"]</MudText>
        @if (_canViewDashboard)
        {
            <MudNavLink Href="/dashboard" Match="NavLinkMatch.All" Icon="@Icons.Filled.Dashboard">@L["Dashboard"]</MudNavLink>
        }
        <MudNavGroup Title="@L["Account"]" Expanded Icon="@Icons.Filled.ManageAccounts">
            <MudNavLink Match="NavLinkMatch.All" Href="/account" Icon="@Icons.Filled.AssignmentInd" Class="custom-nav-child">@L["Profile"]</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Href="/account/address" ForceLoad="true" Icon="@Icons.Filled.Map" Class="custom-nav-child">
                @L["Address"]
                @if (AppDataService.AppUser != default)
                {

                    switch (AppDataService.AppUser.AddressStatus)
                    {
                        case VerificationStatus.Initial:
                            <MudIcon Icon="@Icons.Filled.WarningAmber" Color="Color.Error" Size="Size.Small" Class="mx-2" Title="Action required" />
                            break;
                        case VerificationStatus.Submitted:
                            <MudIcon Icon="@Icons.Filled.FactCheck" Color="Color.Surface" Size="Size.Small" Class="mx-2" Title="Under review" />
                            break;
                        case VerificationStatus.Verified:
                            <MudIcon Icon="@Icons.Filled.CheckCircle" Color="Color.Success" Size="Size.Small" Class="mx-2" Title="Verified" />
                            break;
                    }
                }
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Href="/account/rolepackage" ForceLoad="true" Icon="@Icons.Filled.Fingerprint" Class="custom-nav-child">
                @L["Role and Package"]
                @if (AppDataService.AppUser != default)
                {
                    switch (AppDataService.AppUser.RolePackageStatus)
                    {
                        case VerificationStatus.Initial:
                            <MudIcon Icon="@Icons.Filled.WarningAmber" Color="Color.Error" Size="Size.Small" Class="mx-2" Title="Action required" />
                            break;
                        case VerificationStatus.Submitted:
                            <MudIcon Icon="@Icons.Outlined.WatchLater" Color="Color.Surface" Size="Size.Small" Class="mx-2" Title="Payment or necessary further needed" />
                            break;
                        case VerificationStatus.Verified:
                            <MudIcon Icon="@Icons.Filled.CheckCircle" Color="Color.Success" Size="Size.Small" Class="mx-2" Title="Verified" />
                            break;
                    }
                }
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Href="/account/document" ForceLoad="true" Icon="@Icons.Filled.Face" Class="custom-nav-child">
                @L["Documents"]
                @if (AppDataService.AppUser != default)
                {
                    switch (AppDataService.AppUser.DocumentsStatus)
                    {
                        case VerificationStatus.Initial:
                            <MudIcon Icon="@Icons.Filled.WarningAmber" Color="Color.Error" Size="Size.Small" Class="mx-2" Title="Action required" />
                            break;
                        case VerificationStatus.Submitted:
                            <MudIcon Icon="@Icons.Filled.FactCheck" Color="Color.Surface" Size="Size.Small" Class="mx-2" Title="Under review" />
                            break;
                        case VerificationStatus.Verified:
                            <MudIcon Icon="@Icons.Filled.CheckCircle" Color="Color.Success" Size="Size.Small" Class="mx-2" Title="Verified" />
                            break;
                    }
                }
            </MudNavLink>
        </MudNavGroup>


        @* Loans *@
        @if (_canViewLoans)
        {
            @* <MudText Typo="Typo.subtitle2" Color="Color.Primary" Class="ml-4 my-3">@L["Loans"]</MudText> *@
            <MudNavGroup Title="@L["Loans"]" Expanded Icon="@Icons.TwoTone.ConnectWithoutContact">
                @if (_canViewLoans)
                {
                    <MudNavLink Match="NavLinkMatch.All" Href="/catalog/all/loans" Icon="@Icons.TwoTone.Handshake" Class="custom-nav-child">
                        @L["Loans"]
                    </MudNavLink>
                }
            </MudNavGroup>
        }

        @if (AppDataService.AppUser != default)
        {
            if (AppDataService.AppUser?.RoleName?.Equals("Lender") == true)
            {
                if (_canViewAppUserProducts || _canViewBrands || _canViewCategories)
                {
                    @* <MudText Typo="Typo.subtitle2" Color="Color.Primary" Class="ml-4 my-3">@L["Dependency"]</MudText> *@
                    <MudNavGroup Title="@L["Dependencies"]" Expanded Icon="@Icons.Filled.Storefront">
                        @if (_canViewAppUserProducts)
                        {
                            <MudNavLink Match="NavLinkMatch.All" Href="/catalog/userproducts" Icon="@Icons.Filled.Engineering" Class="custom-nav-child">
                                @L["Products"]
                            </MudNavLink>
                        }
                        @if (_canViewBrands)
                        {
                            <MudNavLink Match="NavLinkMatch.All" Href="/catalog/brands" Icon="@Icons.Filled.Discount" Class="custom-nav-child">
                                @L["Brands"]
                            </MudNavLink>
                        }
                        @if (_canViewCategories)
                        {
                            <MudNavLink Match="NavLinkMatch.All" Href="/catalog/categories" Icon="@Icons.Filled.Category" Class="custom-nav-child">
                                @L["Categories"]
                            </MudNavLink>
                        }
                    </MudNavGroup>
                }

            }

            if (_canViewPackages)
            {
                @* <MudText Typo="Typo.subtitle2" Color="Color.Primary" Class="ml-4 my-3">@L["Dependency"]</MudText> *@
                <MudNavGroup Title="@L["Packages"]" Expanded Icon="@Icons.Outlined.Inventory2">
                    @if (_canViewPackages)
                    {
                        <MudNavLink Match="NavLinkMatch.All" Href="/catalog/packages" Icon="@Icons.Outlined.Inventory2" Class="custom-nav-child">
                            @L["Packages"]
                        </MudNavLink>
                    }
                </MudNavGroup>
            }
        }





        @* Management *@
        @if (CanViewAdministrationGroup)
        {
            <MudText Typo="Typo.subtitle2" Color="Color.Primary" Class="ml-4 my-3">@L["Administration"]</MudText>


            @if (_canViewHangfire)
            {
                <MudNavLink Href="@_hangfireUrl" Match="NavLinkMatch.All" Target="_blank" Icon="@Icons.Material.Filled.Work">@L["Hangfire"]</MudNavLink>
            }

            @if (_canViewUsers)
            {
                <MudNavGroup Title="@L["Users"]" Expanded Icon="@Icons.Filled.VerifiedUser">
                    <MudNavLink Match="NavLinkMatch.All" Href="/users" Icon="@Icons.Material.Filled.PeopleAlt" Class="custom-nav-child">@L["Users"]</MudNavLink>

                    @if (_canViewInputOutputResources)
                    {
                        <MudNavLink Match="NavLinkMatch.All" Href="/catalog/administer/user/identification-files-documents" Icon="@Icons.Material.Filled.FilePresent" Class="custom-nav-child">@L["Verify Files and Documents"]</MudNavLink>
                    }
                </MudNavGroup>
            }
            @if (_canViewRoles)
            {
                <MudNavLink Href="/roles" Icon="@Icons.Material.Filled.EmojiPeople">@L["Roles"]</MudNavLink>
            }
            @if (_canViewTenants)
            {
                <MudNavLink Href="/tenants" Icon="@Icons.Filled.GroupWork" Disabled="!_canViewTenants">@L["Tenants"]</MudNavLink>
            }

            <MudNavLink Href="/audit-logs" Icon="@Icons.Material.Filled.SecurityUpdateGood">@L["Logs"]</MudNavLink>
        }

    </MudNavMenu>
}